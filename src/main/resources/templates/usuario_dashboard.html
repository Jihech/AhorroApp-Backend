<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="es">
<head>
    <meta charset="UTF-8">
    <title>Panel del Usuario</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Estilos -->
    <link th:href="@{/vendor/fontawesome-free/css/all.min.css}" rel="stylesheet" />
    <link th:href="@{/css/sb-admin-2.min.css}" rel="stylesheet" />
    <link th:href="@{/css/usuario-dashboard.css}" rel="stylesheet" />
</head>
<body class="bg-dark">

<div class="container mt-5">
    <h1 class="text-center mb-4 text-white">
        <i class="fas fa-user"></i> Bienvenido, <span th:text="${#authentication.name}">Usuario</span>
    </h1>

    <!-- Tarjetas resumen -->
    <div class="row mb-4">
        <div class="col-md-4 mb-3">
            <div class="card bg-primary text-white shadow">
                <div class="card-body text-center">
                    üí∞ Ingresos
                    <div class="animated-number mt-2" th:data-valor="${ingresos}">S/. 0.00</div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card bg-danger text-white shadow">
                <div class="card-body text-center">
                    üí∏ Gastos
                    <div class="animated-number mt-2" th:data-valor="${gastos}">S/. 0.00</div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card bg-success text-white shadow">
                <div class="card-body text-center">
                    üìä Balance
                    <div class="animated-number mt-2" th:data-valor="${balance}">S/. 0.00</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Progreso de ahorro -->
<div class="card bg-dark border-light mb-4 shadow">
    <div class="card-header bg-secondary text-white">
        <h6 class="m-0 font-weight-bold">üè¶ Meta de ahorro</h6>
    </div>
    <div class="card-body text-white">
        <p>
            Has ahorrado <strong th:text="'S/. ' + ${ahorroActual}"></strong> de <strong th:text="'S/. ' + ${metaAhorro}"></strong>
        </p>
        <div class="progress">
            <div class="progress-bar bg-success" role="progressbar"
                 th:style="'width:' + (${ahorroActual} * 100 / ${metaAhorro}) + '%'"
                 th:text="(${ahorroActual} * 100 / ${metaAhorro}) + '%'">
                60%
            </div>
        </div>
    </div>
</div>

<form th:action="@{/usuario/actualizar-meta}" method="post" class="mt-3">
    <div class="input-group">
        <input type="number" step="0.01" min="0" name="nuevaMeta"
               th:value="${metaAhorro}" class="form-control bg-dark text-white"
               placeholder="Nueva meta de ahorro" required>
        <div class="input-group-append">
            <button type="submit" class="btn btn-success">Actualizar</button>
        </div>
    </div>
</form>



    <!-- Tabla -->
    <div class="card shadow mb-4 bg-dark border-light">
        <div class="card-header bg-secondary text-white">
            <h6 class="m-0 font-weight-bold">üìÑ √öltimos movimientos</h6>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover table-bordered text-white">
                    <thead class="bg-dark text-white">
                        <tr>
                            <th>Fecha</th>
                            <th>Tipo</th>
                            <th>Descripci√≥n</th>
                            <th>Monto</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="mov : ${ultimosMovimientos}">
                            <td th:text="${#dates.format(mov.fecha, 'dd/MM/yyyy')}">01/07/2025</td>
                            <td th:text="${mov.tipo}">Ingreso</td>
                            <td th:text="${mov.descripcion}">Pago</td>
                            <td th:text="'S/. ' + ${mov.monto}">S/. 100.00</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Consejo -->
    <div class="alert alert-warning fade-out">
        <strong>üí° Consejo:</strong> Intenta ahorrar primero y gastar despu√©s. No al rev√©s.
    </div>

    <!-- Logout -->
    <div class="text-center mt-4">
        <a th:href="@{/logout}" class="btn btn-outline-light">
            <i class="fas fa-sign-out-alt"></i> Cerrar sesi√≥n
        </a>
    </div>
</div>

<!-- Scripts -->
<script th:src="@{/js/usuario-dashboard.js}"></script>

</body>
</html>

